(this["webpackJsonplb-recs-client"]=this["webpackJsonplb-recs-client"]||[]).push([[0],{58:function(e){e.exports=JSON.parse('{"a":"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI2N2ViMjcyYTMyMDYzODQ3MmY5YWU5MmExMzI4OWQyOSIsInN1YiI6IjU4ZTljMjA2YzNhMzY4NzJlZTA3MGUwYiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.tp_QuSeL_H8ZvqLTS2Iw8iexf6CkncFtSgQS1qCfNPY"}')},64:function(e,t,n){e.exports=n(91)},69:function(e,t,n){},91:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),i=n.n(c),o=(n(69),n(8)),s=n.n(o),l=n(15),u=n(30),m=n(45),p=n(107),d=n(60),f=n(47);function h(){var e=Object(m.a)(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ",";\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  transition: border 0.24s ease-in-out;\n"]);return h=function(){return e},e}var v=f.a.div(h(),(function(e){return function(e){return e.isDragAccept?"#00e676":e.isDragReject?"#ff1744":e.isDragActive?"#2196f3":"#eeeeee"}(e)})),b=function(e){var t=e.onDrop,n=Object(d.a)({onDrop:t,maxFiles:1,accept:".csv"}),a=n.getRootProps,c=n.getInputProps,i=n.isDragActive,o=n.isDragAccept,s=n.isDragReject;return r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(v,a({className:"dropzone",isDragActive:i,isDragAccept:o,isDragReject:s}),r.a.createElement("input",c()),r.a.createElement("p",null,"Drag and drop ratings.csv here, or click to select file")))},g=n(54),E=n.n(g);function x(e){return w.apply(this,arguments)}function w(){return(w=Object(l.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,E()().fromString(t);case 2:return n=e.sent,a=n.filter((function(e){return parseFloat(e.Rating)>=4.5})),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var y=n(55),j=n(56),k=n(57),O=n.n(k),D=n(25),I=n.n(D),M=n(58),C=function(){function e(t){Object(y.a)(this,e),this.httpClient=void 0,this.lbData=void 0,this.lbData=t,this.httpClient=O.a.create({baseURL:"https://api.themoviedb.org/3",headers:{Authorization:"Bearer ".concat(M.a)}})}return Object(j.a)(e,[{key:"getTMBDMovies",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.lbData.map(function(){var e=Object(l.a)(s.a.mark((function e(t){var a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.httpClient.get("/search/movie?query=".concat(encodeURIComponent(t.Name)));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return e.total_results>0})).map((function(e){return e.results[0]})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRecommendations",value:function(){var e=Object(l.a)(s.a.mark((function e(){var t,n,a,r,c=this;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTMBDMovies();case 2:return t=e.sent,e.next=5,Promise.all(t.map(function(){var e=Object(l.a)(s.a.mark((function e(t){var n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.httpClient.get("/movie/".concat(t.id,"/recommendations"));case 2:return n=e.sent,a=n.data,e.abrupt("return",{movie:t,recommendations:a.results.slice(0,5)});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return n=e.sent,a=I.a.uniqBy(n,(function(e){return e.movie.id})).filter((function(e){return e.recommendations.length>0&&!I.a.isNull(e.movie.backdrop_path&&!I.a.isNull(e.movie.poster_path))})),r=I()(n.map((function(e){return e.recommendations}))).flatten().groupBy("id").orderBy((function(e){return e.length}),"desc").flatten().uniqBy((function(e){return e.id})).value().slice(0,5),e.abrupt("return",{common:r,recommendations:a});case 10:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),J=n(109),N=n(111),R=n(110),S=function(e){var t=e.results;return r.a.createElement(p.a,{container:!0,direction:"column",spacing:2},r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement(J.a,{variant:"h3"},"Most Common Recommendations")),t.common.map((function(e){return r.a.createElement(p.a,{container:!0,key:e.id,direction:"row",justify:"center"},r.a.createElement(p.a,{item:!0,xs:3},r.a.createElement("img",{alt:"".concat(e.title,"-poster"),src:"https://image.tmdb.org/t/p/w300".concat(e.backdrop_path)})),r.a.createElement(p.a,{item:!0,xs:!0},r.a.createElement(J.a,{variant:"h5"},e.title),r.a.createElement(J.a,{variant:"body1"},e.overview)))})),r.a.createElement(p.a,{container:!0,direction:"row"},r.a.createElement(p.a,{item:!0,xs:2},r.a.createElement(J.a,{variant:"h3"},"Movie")),r.a.createElement(p.a,{item:!0,xs:!0},r.a.createElement(J.a,{variant:"h3"},"Recommended Movies"))),t.recommendations.map((function(e){return r.a.createElement(p.a,{item:!0,key:e.movie.id},r.a.createElement(p.a,{container:!0,direction:"row"},r.a.createElement(p.a,{item:!0,xs:2},r.a.createElement(N.a,{title:e.movie.title,placement:"right"},r.a.createElement("a",{href:"https://themoviedb.org/movie/".concat(e.movie.id),rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{alt:"".concat(e.movie.title,"-poster"),src:"https://image.tmdb.org/t/p/w154".concat(e.movie.poster_path)}))),r.a.createElement(R.a,{orientation:"vertical",variant:"middle"})),r.a.createElement(p.a,{item:!0,xs:!0},r.a.createElement(p.a,{container:!0,direction:"row"},e.recommendations.map((function(e){return r.a.createElement(p.a,{item:!0,key:e.id,xs:2},r.a.createElement(N.a,{title:e.title,placement:"right"},r.a.createElement("a",{href:"https://themoviedb.org/movie/".concat(e.id),rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{key:e.id,alt:"".concat(e.title,"-poster"),src:"https://image.tmdb.org/t/p/w154".concat(e.poster_path)}))))}))))))})))},A=n(112),B=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(null),o=Object(u.a)(i,2),m=o[0],d=o[1],f=Object(a.useState)(null),h=Object(u.a)(f,2),v=h[0],g=h[1],E=Object(a.useCallback)((function(e){var t=e[0];c(t.name);var n=new FileReader;n.onload=function(){d(n.result)},n.readAsText(t)}),[]);Object(a.useEffect)((function(){function e(){return(e=Object(l.a)(s.a.mark((function e(){var t,n,a;return s.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===m){e.next=10;break}return e.next=3,x(m);case 3:return t=e.sent,n=new C(t),e.next=7,n.getRecommendations();case 7:a=e.sent,console.log(a),g(a);case 10:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[m]);return r.a.createElement(p.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},null===n&&r.a.createElement(b,{onDrop:E}),r.a.createElement(p.a,{item:!0},r.a.createElement(A.a,{onClick:function(){c(null),g(null),d(null)}},"clear")),r.a.createElement(p.a,{item:!0,xs:12},r.a.createElement("ol",null,r.a.createElement("li",null,r.a.createElement(J.a,{variant:"subtitle1"},"Go to ",r.a.createElement("a",{href:"https://letterboxd.com/settings/data"},"letterboxd.com/settings/data"),' and click "Export your data"')),r.a.createElement("li",null,r.a.createElement(J.a,{variant:"subtitle1"},'Upload "ratings.csv" by clicking the "Upload" button below')),r.a.createElement("li",null,r.a.createElement(J.a,{variant:"subtitle1"},"Page will populate with recommendations based on your Letterboxd ratings!")))),v&&r.a.createElement(S,{results:v}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(B,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[64,1,2]]]);
//# sourceMappingURL=main.ecb1ecd4.chunk.js.map
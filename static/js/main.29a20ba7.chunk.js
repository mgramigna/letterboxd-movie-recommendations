(this["webpackJsonplb-recs-client"]=this["webpackJsonplb-recs-client"]||[]).push([[0],{102:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(11),i=n.n(c),o=(n(77),n(12)),l=n.n(o),s=n(16),u=n(21),m=n(27),d=n(52),p=n(20),f=n.n(p),h=n(120),b=n(66),v=n(28);function g(){var e=Object(m.a)(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ",";\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  transition: border 0.24s ease-in-out;\n"]);return g=function(){return e},e}var E=v.a.div(g(),(function(e){return function(e){return e.isDragAccept?"#00e676":e.isDragReject?"#ff1744":e.isDragActive?"#2196f3":"#eeeeee"}(e)})),x=function(e){var t=e.onDrop,n=Object(b.a)({onDrop:t,maxFiles:1,accept:".csv"}),a=n.getRootProps,c=n.getInputProps,i=n.isDragActive,o=n.isDragAccept,l=n.isDragReject;return r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(E,a({className:"dropzone",isDragActive:i,isDragAccept:o,isDragReject:l}),r.a.createElement("input",c()),r.a.createElement("p",null,"Drag and drop ratings.csv here, or click to select file")))},j=n(60),w=n.n(j);function y(e,t){return O.apply(this,arguments)}function O(){return(O=Object(s.a)(l.a.mark((function e(t,n){var a,r;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,w()().fromString(t);case 2:return a=e.sent,r=a.filter((function(e){return parseFloat(e.Rating)>=n[0]&&parseFloat(e.Rating)<=n[1]})),e.abrupt("return",r);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=n(61),D=n(62),S=n(63),I=n.n(S),M=n(64),R=function(){function e(t){Object(k.a)(this,e),this.httpClient=void 0,this.lbData=void 0,this.lbData=t,this.httpClient=I.a.create({baseURL:"https://api.themoviedb.org/3",headers:{Authorization:"Bearer ".concat(M.a)}})}return Object(D.a)(e,[{key:"getTMBDMovies",value:function(){var e=Object(s.a)(l.a.mark((function e(){var t,n=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.lbData.map(function(){var e=Object(s.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.httpClient.get("/search/movie?query=".concat(encodeURIComponent(t.Name)));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return e.total_results>0})).map((function(e){return e.results[0]})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRecommendations",value:function(){var e=Object(s.a)(l.a.mark((function e(){var t,n,a,r,c=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTMBDMovies();case 2:return t=e.sent,e.next=5,Promise.all(t.map(function(){var e=Object(s.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.httpClient.get("/movie/".concat(t.id,"/recommendations"));case 2:return n=e.sent,a=n.data,e.abrupt("return",{movie:t,recommendations:a.results.slice(0,5)});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return n=e.sent,a=f.a.uniqBy(n,(function(e){return e.movie.id})).filter((function(e){return e.recommendations.length>0&&!f.a.isNull(e.movie.backdrop_path&&!f.a.isNull(e.movie.poster_path))})),r=f()(n.map((function(e){return e.recommendations}))).flatten().groupBy("id").orderBy((function(e){return e.length}),"desc").flatten().uniqBy((function(e){return e.id})).value().slice(0,5),e.abrupt("return",{common:r,recommendations:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),C=n(122),N=n(127),B=n(123),J=function(e){var t=e.results;return r.a.createElement(h.a,{container:!0,direction:"column",spacing:2},r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(C.a,{variant:"h3"},"Most Common Recommendations")),t.common.map((function(e){return r.a.createElement(h.a,{container:!0,key:e.id,direction:"row",justify:"center"},r.a.createElement(h.a,{item:!0,xs:3},r.a.createElement("img",{alt:"".concat(e.title,"-poster"),src:"https://image.tmdb.org/t/p/w300".concat(e.backdrop_path)})),r.a.createElement(h.a,{item:!0,xs:!0},r.a.createElement(C.a,{variant:"h5"},e.title),r.a.createElement(C.a,{variant:"body1"},e.overview)))})),r.a.createElement(h.a,{container:!0,direction:"row"},r.a.createElement(h.a,{item:!0,xs:2},r.a.createElement(C.a,{variant:"h3"},"Movie")),r.a.createElement(h.a,{item:!0,xs:!0},r.a.createElement(C.a,{variant:"h3"},"Recommended Movies"))),t.recommendations.map((function(e){return r.a.createElement(h.a,{item:!0,key:e.movie.id},r.a.createElement(h.a,{container:!0,direction:"row"},r.a.createElement(h.a,{item:!0,xs:2},r.a.createElement(N.a,{title:e.movie.title,placement:"right"},r.a.createElement("a",{href:"https://themoviedb.org/movie/".concat(e.movie.id),rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{alt:"".concat(e.movie.title,"-poster"),src:"https://image.tmdb.org/t/p/w154".concat(e.movie.poster_path)}))),r.a.createElement(B.a,{orientation:"vertical",variant:"middle"})),r.a.createElement(h.a,{item:!0,xs:!0},r.a.createElement(h.a,{container:!0,direction:"row"},e.recommendations.map((function(e){return r.a.createElement(h.a,{item:!0,key:e.id,xs:2},r.a.createElement(N.a,{title:e.title,placement:"right"},r.a.createElement("a",{href:"https://themoviedb.org/movie/".concat(e.id),rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{key:e.id,alt:"".concat(e.title,"-poster"),src:"https://image.tmdb.org/t/p/w154".concat(e.poster_path)}))))}))))))})))},Y=n(129),_=n(124),A=n(125),z=n(126),L=n(128);function U(){var e=Object(m.a)(["\n  width: 400px;\n"]);return U=function(){return e},e}function T(){var e=Object(m.a)(["\n  text-decoration: none;\n  color: inherit;\n"]);return T=function(){return e},e}var W=Object(v.a)(d.CSVLink)(T()),q=Object(v.a)(Y.a)(U()),P=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(null),o=Object(u.a)(i,2),m=o[0],d=o[1],p=Object(a.useState)(null),b=Object(u.a)(p,2),v=b[0],g=b[1],E=Object(a.useState)([[]]),j=Object(u.a)(E,2),w=j[0],O=j[1],k=Object(a.useState)(!1),D=Object(u.a)(k,2),S=D[0],I=D[1],M=Object(a.useState)([4.5,5]),B=Object(u.a)(M,2),Y=B[0],U=B[1],T=Object(a.useState)(!1),P=Object(u.a)(T,2),Q=P[0],V=P[1],F=Object(a.useCallback)((function(e){var t=e[0];c(t.name),V(!0);var n=new FileReader;n.onload=function(){d(n.result)},n.readAsText(t)}),[]);Object(a.useEffect)((function(){function e(){return(e=Object(s.a)(l.a.mark((function e(){var t,n,a,r,c,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===m){e.next=17;break}return e.next=3,y(m,Y);case 3:return t=e.sent,n=new R(t),e.next=7,n.getRecommendations();case 7:a=e.sent,g(a),V(!1),r=a.recommendations.map((function(e){return e.recommendations})),c=a.common.concat(f.a.flatten(r)),i=f.a.uniqBy(c,(function(e){return e.id})),(o=i.map((function(e){return[e.release_date,e.title]}))).unshift(["Date","Name"]),O(o),I(!0);case 17:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[m,Y]);return r.a.createElement(h.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},null===n&&r.a.createElement(x,{onDrop:F}),r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(C.a,{gutterBottom:!0},"Valid Rating Range (Your Ratings)"," ",r.a.createElement(N.a,{title:"Set the min/max rating value to be considered for recommendations"},r.a.createElement(_.a,null,r.a.createElement(L.a,null)))),r.a.createElement(q,{value:Y,valueLabelDisplay:"auto",step:.5,marks:!0,min:.5,max:5,onChange:function(e,t){U(t)},disabled:null!==n})),r.a.createElement(h.a,{item:!0},r.a.createElement(A.a,{onClick:function(){c(null),g(null),d(null),I(!1),O([[]])}},"clear")),r.a.createElement(h.a,{item:!0},r.a.createElement(A.a,{disabled:!S},r.a.createElement(W,{filename:"letterboxd-movie-recommendations.csv",data:w},"Download Results CSV"))),r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement("ol",null,r.a.createElement("li",null,r.a.createElement(C.a,{variant:"subtitle1"},"Go to ",r.a.createElement("a",{href:"https://letterboxd.com/settings/data"},"letterboxd.com/settings/data"),' and click "Export your data"')),r.a.createElement("li",null,r.a.createElement(C.a,{variant:"subtitle1"},'Upload "ratings.csv" by clicking the "Upload" box above')),r.a.createElement("li",null,r.a.createElement(C.a,{variant:"subtitle1"},"Page will populate with recommendations based on your Letterboxd ratings!")),r.a.createElement("li",null,r.a.createElement(C.a,{variant:"subtitle1"},"You can download a CSV of all the recommended films and import them into a Letterboxd list or watchlist")))),v&&r.a.createElement(J,{results:v}),Q&&r.a.createElement(z.a,null))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(P,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))},64:function(e){e.exports=JSON.parse('{"a":"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI2N2ViMjcyYTMyMDYzODQ3MmY5YWU5MmExMzI4OWQyOSIsInN1YiI6IjU4ZTljMjA2YzNhMzY4NzJlZTA3MGUwYiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.tp_QuSeL_H8ZvqLTS2Iw8iexf6CkncFtSgQS1qCfNPY"}')},72:function(e,t,n){e.exports=n(102)},77:function(e,t,n){}},[[72,1,2]]]);
//# sourceMappingURL=main.29a20ba7.chunk.js.map
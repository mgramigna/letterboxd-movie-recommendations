(this["webpackJsonplb-recs-client"]=this["webpackJsonplb-recs-client"]||[]).push([[0],{61:function(e){e.exports=JSON.parse('{"a":"eyJhbGciOiJIUzI1NiJ9.eyJhdWQiOiI2N2ViMjcyYTMyMDYzODQ3MmY5YWU5MmExMzI4OWQyOSIsInN1YiI6IjU4ZTljMjA2YzNhMzY4NzJlZTA3MGUwYiIsInNjb3BlcyI6WyJhcGlfcmVhZCJdLCJ2ZXJzaW9uIjoxfQ.tp_QuSeL_H8ZvqLTS2Iw8iexf6CkncFtSgQS1qCfNPY"}')},67:function(e,t,n){e.exports=n(97)},72:function(e,t,n){},97:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),c=n(7),i=n.n(c),o=(n(72),n(8)),l=n.n(o),s=n(15),u=n(22),m=n(27),p=n(49),d=n(17),f=n.n(d),h=n(113),v=n(63),b=n(28);function g(){var e=Object(m.a)(["\n  flex: 1;\n  display: flex;\n  flex-direction: column;\n  align-items: center;\n  padding: 20px;\n  border-width: 2px;\n  border-radius: 2px;\n  border-color: ",";\n  border-style: dashed;\n  background-color: #fafafa;\n  color: #bdbdbd;\n  outline: none;\n  transition: border 0.24s ease-in-out;\n"]);return g=function(){return e},e}var E=b.a.div(g(),(function(e){return function(e){return e.isDragAccept?"#00e676":e.isDragReject?"#ff1744":e.isDragActive?"#2196f3":"#eeeeee"}(e)})),x=function(e){var t=e.onDrop,n=Object(v.a)({onDrop:t,maxFiles:1,accept:".csv"}),a=n.getRootProps,c=n.getInputProps,i=n.isDragActive,o=n.isDragAccept,l=n.isDragReject;return r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(E,a({className:"dropzone",isDragActive:i,isDragAccept:o,isDragReject:l}),r.a.createElement("input",c()),r.a.createElement("p",null,"Drag and drop ratings.csv here, or click to select file")))},w=n(57),y=n.n(w);function j(e){return O.apply(this,arguments)}function O(){return(O=Object(s.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,y()().fromString(t);case 2:return n=e.sent,a=n.filter((function(e){return parseFloat(e.Rating)>=4.5})),e.abrupt("return",a);case 5:case"end":return e.stop()}}),e)})))).apply(this,arguments)}var k=n(58),D=n(59),I=n(60),M=n.n(I),S=n(61),C=function(){function e(t){Object(k.a)(this,e),this.httpClient=void 0,this.lbData=void 0,this.lbData=t,this.httpClient=M.a.create({baseURL:"https://api.themoviedb.org/3",headers:{Authorization:"Bearer ".concat(S.a)}})}return Object(D.a)(e,[{key:"getTMBDMovies",value:function(){var e=Object(s.a)(l.a.mark((function e(){var t,n=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,Promise.all(this.lbData.map(function(){var e=Object(s.a)(l.a.mark((function e(t){var a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,n.httpClient.get("/search/movie?query=".concat(encodeURIComponent(t.Name)));case 2:return a=e.sent,e.abrupt("return",a.data);case 4:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 2:return t=e.sent,e.abrupt("return",t.filter((function(e){return e.total_results>0})).map((function(e){return e.results[0]})));case 4:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()},{key:"getRecommendations",value:function(){var e=Object(s.a)(l.a.mark((function e(){var t,n,a,r,c=this;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,this.getTMBDMovies();case 2:return t=e.sent,e.next=5,Promise.all(t.map(function(){var e=Object(s.a)(l.a.mark((function e(t){var n,a;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,c.httpClient.get("/movie/".concat(t.id,"/recommendations"));case 2:return n=e.sent,a=n.data,e.abrupt("return",{movie:t,recommendations:a.results.slice(0,5)});case 5:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}()));case 5:return n=e.sent,a=f.a.uniqBy(n,(function(e){return e.movie.id})).filter((function(e){return e.recommendations.length>0&&!f.a.isNull(e.movie.backdrop_path&&!f.a.isNull(e.movie.poster_path))})),r=f()(n.map((function(e){return e.recommendations}))).flatten().groupBy("id").orderBy((function(e){return e.length}),"desc").flatten().uniqBy((function(e){return e.id})).value().slice(0,5),e.abrupt("return",{common:r,recommendations:a});case 9:case"end":return e.stop()}}),e,this)})));return function(){return e.apply(this,arguments)}}()}]),e}(),N=n(115),R=n(117),J=n(116),B=function(e){var t=e.results;return r.a.createElement(h.a,{container:!0,direction:"column",spacing:2},r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement(N.a,{variant:"h3"},"Most Common Recommendations")),t.common.map((function(e){return r.a.createElement(h.a,{container:!0,key:e.id,direction:"row",justify:"center"},r.a.createElement(h.a,{item:!0,xs:3},r.a.createElement("img",{alt:"".concat(e.title,"-poster"),src:"https://image.tmdb.org/t/p/w300".concat(e.backdrop_path)})),r.a.createElement(h.a,{item:!0,xs:!0},r.a.createElement(N.a,{variant:"h5"},e.title),r.a.createElement(N.a,{variant:"body1"},e.overview)))})),r.a.createElement(h.a,{container:!0,direction:"row"},r.a.createElement(h.a,{item:!0,xs:2},r.a.createElement(N.a,{variant:"h3"},"Movie")),r.a.createElement(h.a,{item:!0,xs:!0},r.a.createElement(N.a,{variant:"h3"},"Recommended Movies"))),t.recommendations.map((function(e){return r.a.createElement(h.a,{item:!0,key:e.movie.id},r.a.createElement(h.a,{container:!0,direction:"row"},r.a.createElement(h.a,{item:!0,xs:2},r.a.createElement(R.a,{title:e.movie.title,placement:"right"},r.a.createElement("a",{href:"https://themoviedb.org/movie/".concat(e.movie.id),rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{alt:"".concat(e.movie.title,"-poster"),src:"https://image.tmdb.org/t/p/w154".concat(e.movie.poster_path)}))),r.a.createElement(J.a,{orientation:"vertical",variant:"middle"})),r.a.createElement(h.a,{item:!0,xs:!0},r.a.createElement(h.a,{container:!0,direction:"row"},e.recommendations.map((function(e){return r.a.createElement(h.a,{item:!0,key:e.id,xs:2},r.a.createElement(R.a,{title:e.title,placement:"right"},r.a.createElement("a",{href:"https://themoviedb.org/movie/".concat(e.id),rel:"noopener noreferrer",target:"_blank"},r.a.createElement("img",{key:e.id,alt:"".concat(e.title,"-poster"),src:"https://image.tmdb.org/t/p/w154".concat(e.poster_path)}))))}))))))})))},_=n(118);function A(){var e=Object(m.a)(["\n  text-decoration: none;\n  color: inherit;\n"]);return A=function(){return e},e}var Y=Object(b.a)(p.CSVLink)(A()),z=function(){var e=Object(a.useState)(null),t=Object(u.a)(e,2),n=t[0],c=t[1],i=Object(a.useState)(null),o=Object(u.a)(i,2),m=o[0],p=o[1],d=Object(a.useState)(null),v=Object(u.a)(d,2),b=v[0],g=v[1],E=Object(a.useState)([[]]),w=Object(u.a)(E,2),y=w[0],O=w[1],k=Object(a.useState)(!1),D=Object(u.a)(k,2),I=D[0],M=D[1],S=Object(a.useCallback)((function(e){var t=e[0];c(t.name);var n=new FileReader;n.onload=function(){p(n.result)},n.readAsText(t)}),[]);Object(a.useEffect)((function(){function e(){return(e=Object(s.a)(l.a.mark((function e(){var t,n,a,r,c,i,o;return l.a.wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(null===m){e.next=16;break}return e.next=3,j(m);case 3:return t=e.sent,n=new C(t),e.next=7,n.getRecommendations();case 7:a=e.sent,g(a),r=a.recommendations.map((function(e){return e.recommendations})),c=a.common.concat(f.a.flatten(r)),i=f.a.uniqBy(c,(function(e){return e.id})),(o=i.map((function(e){return[e.release_date,e.title]}))).unshift(["Date","Name"]),O(o),M(!0);case 16:case"end":return e.stop()}}),e)})))).apply(this,arguments)}!function(){e.apply(this,arguments)}()}),[m]);return r.a.createElement(h.a,{container:!0,direction:"column",justify:"center",alignItems:"center"},null===n&&r.a.createElement(x,{onDrop:S}),r.a.createElement(h.a,{item:!0},r.a.createElement(_.a,{onClick:function(){c(null),g(null),p(null),M(!1),O([[]])}},"clear")),r.a.createElement(h.a,{item:!0},r.a.createElement(_.a,{disabled:!I},r.a.createElement(Y,{filename:"letterboxd-movie-recommendations.csv",data:y},"Download Results CSV"))),r.a.createElement(h.a,{item:!0,xs:12},r.a.createElement("ol",null,r.a.createElement("li",null,r.a.createElement(N.a,{variant:"subtitle1"},"Go to ",r.a.createElement("a",{href:"https://letterboxd.com/settings/data"},"letterboxd.com/settings/data"),' and click "Export your data"')),r.a.createElement("li",null,r.a.createElement(N.a,{variant:"subtitle1"},'Upload "ratings.csv" by clicking the "Upload" box above')),r.a.createElement("li",null,r.a.createElement(N.a,{variant:"subtitle1"},"Page will populate with recommendations based on your Letterboxd ratings!")),r.a.createElement("li",null,r.a.createElement(N.a,{variant:"subtitle1"},"You can download a CSV of all the recommended films and import them into a Letterboxd list or watchlist")))),b&&r.a.createElement(B,{results:b}))};Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));i.a.render(r.a.createElement(r.a.StrictMode,null,r.a.createElement(z,null)),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then((function(e){e.unregister()})).catch((function(e){console.error(e.message)}))}},[[67,1,2]]]);
//# sourceMappingURL=main.f827961b.chunk.js.map